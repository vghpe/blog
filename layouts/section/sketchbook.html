{{ define "main" }}

{{ partial "profile.html" . }}

<div id="notes-page">
  <div id="list-page" class="sketchbook-grid">

  {{/* Aggregate pages from the notes section and present as Sketchbook */}}
  {{ $notePages := where .Site.RegularPages "Section" "notes" }}
  {{ $paginator := .Paginate $notePages }}
  {{ range $paginator.Pages }}
  
  <section class="item">
    <!-- Date at top, right-aligned, tight to image -->
    <div class="date-top">
      <time datetime="{{ .PublishDate }}">{{ .PublishDate.Format "Jan 2, 2006" }}</time>
    </div>

    <div class="content content-center">
      {{ if .Params.tweet }}
        <blockquote class="twitter-tweet">
          <a href="{{ .Params.tweet }}"></a>
        </blockquote>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        {{ if .Params.caption }}
          <p class="image-caption">{{ .Params.caption }}</p>
        {{ end }}
      {{ else if .Params.photo }}
        {{ $page := . }}
        {{ with index $page.Params.photo 0 }}
          {{ with .url }}
            <img src="{{ . | absURL }}" alt="{{ $page.Title }}">
          {{ else }}
            <img src="{{ . | absURL }}" alt="{{ $page.Title }}">
          {{ end }}
        {{ end }}
        {{ if $page.Params.caption }}
          <p class="image-caption">{{ $page.Params.caption }}</p>
        {{ end }}
      {{ else if .Params.image }}
        <img src="{{ .Params.image | absURL }}" alt="{{ .Title }}">
        {{ if .Params.caption }}
          <p class="image-caption">{{ .Params.caption }}</p>
        {{ end }}
      {{ end }}
    </div>

    <div class="summary-text">
      {{ .Content }}
    </div>
  </section>
  {{ end }}

  {{ if or ($paginator.HasPrev) ($paginator.HasNext) }}
    <div class="pagination">
      {{ if $paginator.HasPrev }}
        <span class="prev">
          <a href="{{ $paginator.Prev.URL }}">← Newer</a>
        </span>
      {{ end }}

      {{ if $paginator.HasNext }}
        <span class="next">
          <a href="{{ $paginator.Next.URL }}">Older →</a>
        </span>
      {{ end }}
    </div>
  {{ end }}
  </div>
</div>

{{ end }}
